<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pytem.cc_reduce_data &mdash; polyTEM 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=2709fde1"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pytem.cc_reduce_data.bandpass_filter" href="pytem.cc_reduce_data.bandpass_filter.html" />
    <link rel="prev" title="pytem.cc_drift_correction.track_drift" href="pytem.cc_drift_correction.track_drift.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            polyTEM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pytem.html">pytem</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pytem.cc_drift_correction.html">pytem.cc_drift_correction</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">pytem.cc_reduce_data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.bandpass_filter.html">pytem.cc_reduce_data.bandpass_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.bandpass_filtering_image.html">pytem.cc_reduce_data.bandpass_filtering_image</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.create_carbon_mask.html">pytem.cc_reduce_data.create_carbon_mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.extract_intensity_q_lineout.html">pytem.cc_reduce_data.extract_intensity_q_lineout</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.gaussian_q_filter.html">pytem.cc_reduce_data.gaussian_q_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.get_datacube.html">pytem.cc_reduce_data.get_datacube</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.get_orientation_torch.html">pytem.cc_reduce_data.get_orientation_torch</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.get_q_pixels.html">pytem.cc_reduce_data.get_q_pixels</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.make_gaussian_filter_tensor.html">pytem.cc_reduce_data.make_gaussian_filter_tensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.median_filter.html">pytem.cc_reduce_data.median_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.normalize_tensor.html">pytem.cc_reduce_data.normalize_tensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.raised_cosine_window_np.html">pytem.cc_reduce_data.raised_cosine_window_np</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.subplot_mini.html">pytem.cc_reduce_data.subplot_mini</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.tensor_fft.html">pytem.cc_reduce_data.tensor_fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="pytem.cc_reduce_data.tensor_shift_fft.html">pytem.cc_reduce_data.tensor_shift_fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.bandpass_filter"><code class="docutils literal notranslate"><span class="pre">bandpass_filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.bandpass_filtering_image"><code class="docutils literal notranslate"><span class="pre">bandpass_filtering_image()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.create_carbon_mask"><code class="docutils literal notranslate"><span class="pre">create_carbon_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.extract_intensity_q_lineout"><code class="docutils literal notranslate"><span class="pre">extract_intensity_q_lineout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.gaussian_q_filter"><code class="docutils literal notranslate"><span class="pre">gaussian_q_filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.get_datacube"><code class="docutils literal notranslate"><span class="pre">get_datacube()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.get_orientation_torch"><code class="docutils literal notranslate"><span class="pre">get_orientation_torch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.get_q_pixels"><code class="docutils literal notranslate"><span class="pre">get_q_pixels()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.make_gaussian_filter_tensor"><code class="docutils literal notranslate"><span class="pre">make_gaussian_filter_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.median_filter"><code class="docutils literal notranslate"><span class="pre">median_filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.normalize_tensor"><code class="docutils literal notranslate"><span class="pre">normalize_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.raised_cosine_window_np"><code class="docutils literal notranslate"><span class="pre">raised_cosine_window_np()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.subplot_mini"><code class="docutils literal notranslate"><span class="pre">subplot_mini()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.tensor_fft"><code class="docutils literal notranslate"><span class="pre">tensor_fft()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytem.cc_reduce_data.tensor_shift_fft"><code class="docutils literal notranslate"><span class="pre">tensor_shift_fft()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pytem.crystal_peaks.html">pytem.crystal_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytem.image.html">pytem.image</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytem.paracrystalline.html">pytem.paracrystalline</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytem.params.html">pytem.params</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytem.spatial.html">pytem.spatial</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytem.spatial_analysis.html">pytem.spatial_analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytem.statistics.html">pytem.statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytem.tol_colors.html">pytem.tol_colors</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytem.utilities.html">pytem.utilities</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">polyTEM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API</a></li>
          <li class="breadcrumb-item"><a href="pytem.html">pytem</a></li>
      <li class="breadcrumb-item active">pytem.cc_reduce_data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/pytem.cc_reduce_data.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pytem.cc_reduce_data">
<span id="pytem-cc-reduce-data"></span><h1>pytem.cc_reduce_data<a class="headerlink" href="#module-pytem.cc_reduce_data" title="Link to this heading"></a></h1>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="pytem.cc_reduce_data.bandpass_filter.html#pytem.cc_reduce_data.bandpass_filter" title="pytem.cc_reduce_data.bandpass_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bandpass_filter</span></code></a>(M, q_low, q_high, dx)</p></td>
<td><p>Generates bandpass filter of size MxM for range of frequencies (q_low, q_high).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pytem.cc_reduce_data.bandpass_filtering_image.html#pytem.cc_reduce_data.bandpass_filtering_image" title="pytem.cc_reduce_data.bandpass_filtering_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bandpass_filtering_image</span></code></a>(img_gpu, q, ...[, ...])</p></td>
<td><p>Computes FT of image, multiplies by user-defined filter, and computes the inverse FT to get a filtered version of the image.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pytem.cc_reduce_data.create_carbon_mask.html#pytem.cc_reduce_data.create_carbon_mask" title="pytem.cc_reduce_data.create_carbon_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_carbon_mask</span></code></a>(image[, k_size, ...])</p></td>
<td><p>Uses otsu's thresholding to identify the regions with lacey carbon Otsu's thresholding works by finding an intensity value to separate the image into different pixel groups such that the inter-group variance is minimized.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pytem.cc_reduce_data.extract_intensity_q_lineout.html#pytem.cc_reduce_data.extract_intensity_q_lineout" title="pytem.cc_reduce_data.extract_intensity_q_lineout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extract_intensity_q_lineout</span></code></a>(fft_gpu, ...[, ...])</p></td>
<td><p>Function performs azimuthal intensity integrations as function of q for selected q bandwidth.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pytem.cc_reduce_data.gaussian_q_filter.html#pytem.cc_reduce_data.gaussian_q_filter" title="pytem.cc_reduce_data.gaussian_q_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gaussian_q_filter</span></code></a>(q, sigma_q, sigma_th, M, dx)</p></td>
<td><p>Generates gaussian filter in Fourier space for designated q center and bandwidth.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pytem.cc_reduce_data.get_datacube.html#pytem.cc_reduce_data.get_datacube" title="pytem.cc_reduce_data.get_datacube"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_datacube</span></code></a>(img_gpu, angles, step_size, ...)</p></td>
<td><p>Get intensity - theta 4D array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pytem.cc_reduce_data.get_orientation_torch.html#pytem.cc_reduce_data.get_orientation_torch" title="pytem.cc_reduce_data.get_orientation_torch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_orientation_torch</span></code></a>(fft, filters, device)</p></td>
<td><p>Gets Intensity tensor for different angles at any grid point (x,y).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pytem.cc_reduce_data.get_q_pixels.html#pytem.cc_reduce_data.get_q_pixels" title="pytem.cc_reduce_data.get_q_pixels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_q_pixels</span></code></a>(q, M, dx)</p></td>
<td><p>Conversion of reciprocal space component in angstroms to spatial frequency in number of pixels.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pytem.cc_reduce_data.make_gaussian_filter_tensor.html#pytem.cc_reduce_data.make_gaussian_filter_tensor" title="pytem.cc_reduce_data.make_gaussian_filter_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_gaussian_filter_tensor</span></code></a>(single_filter, ...)</p></td>
<td><p>Generates 3D tensor of size (M, M, number_angles) with stack of rotated Fourier filters to be used for datacube extraction.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pytem.cc_reduce_data.median_filter.html#pytem.cc_reduce_data.median_filter" title="pytem.cc_reduce_data.median_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">median_filter</span></code></a>(data[, size, device])</p></td>
<td><p>Median filter operation for n-dimension tensor or array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pytem.cc_reduce_data.normalize_tensor.html#pytem.cc_reduce_data.normalize_tensor" title="pytem.cc_reduce_data.normalize_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalize_tensor</span></code></a>(tensor)</p></td>
<td><p>Tensor normalization operation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pytem.cc_reduce_data.raised_cosine_window_np.html#pytem.cc_reduce_data.raised_cosine_window_np" title="pytem.cc_reduce_data.raised_cosine_window_np"><code class="xref py py-obj docutils literal notranslate"><span class="pre">raised_cosine_window_np</span></code></a>(s[, beta])</p></td>
<td><p>Generate 1D raised cosine window of length s and with roll-factor beta. :param s: pixel lenght of signal :param beta: roll-factor beta. Default=0.2 mainly zeroes down signal close to edges of image. :return:      frequencies, window: frequency values and corresponding raised cosine signal.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pytem.cc_reduce_data.subplot_mini.html#pytem.cc_reduce_data.subplot_mini" title="pytem.cc_reduce_data.subplot_mini"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subplot_mini</span></code></a>(image, fft_raw, I_vs_th[, ...])</p></td>
<td><p>Plots stack of figures to describe nano-FFT extraction process.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pytem.cc_reduce_data.tensor_fft.html#pytem.cc_reduce_data.tensor_fft" title="pytem.cc_reduce_data.tensor_fft"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tensor_fft</span></code></a>(tensor, s[, print_time])</p></td>
<td><p>Returns powder spectrum of 2D tensor (image) using PyTorch implementation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pytem.cc_reduce_data.tensor_shift_fft.html#pytem.cc_reduce_data.tensor_shift_fft" title="pytem.cc_reduce_data.tensor_shift_fft"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tensor_shift_fft</span></code></a>(fft)</p></td>
<td><p>Shift zero frequency spatial frequency component to center of 2D image.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.bandpass_filter">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">bandpass_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_high</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#bandpass_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.bandpass_filter" title="Link to this definition"></a></dt>
<dd><p>Generates bandpass filter of size MxM for range of frequencies (q_low, q_high).
:param M: size in pixels of output bandpass filter(in fourier space)
:param q_low: minimum q value in inverse Angstroms
:param q_high: maximum q value in inverse Angstroms
:param dx: HRTEM image resolution in Angstroms/pixel</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array size (M, M) with ones for pixels between selected bandwidth of q values and zeros elsewhere.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>mask</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.bandpass_filtering_image">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">bandpass_filtering_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_gpu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_bandwidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#bandpass_filtering_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.bandpass_filtering_image" title="Link to this definition"></a></dt>
<dd><p>Computes FT of image, multiplies by user-defined filter, and computes the inverse FT to get
a filtered version of the image.
:param img_gpu: image in Torch. Image can be any size and function allows for m != n
:param q: spatial frequency center
:param q_bandwidth: bandwidth of spatial frequency filter
:param dx: pixel size in Angstrom/pixel
:param beta: raised cosine beta coefficient
:param device: default to ‘cuda’
:return: inverse fourier transform of image after applying raised cosine window and bandpass filter. Torch tensor.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.create_carbon_mask">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">create_carbon_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">19</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#create_carbon_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.create_carbon_mask" title="Link to this definition"></a></dt>
<dd><p>Uses otsu’s thresholding to identify the regions with lacey carbon
Otsu’s thresholding works by finding an intensity value to separate the image into different pixel groups
such that the inter-group variance is minimized.</p>
<p>INPUT:
image - 2D numpy array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.extract_intensity_q_lineout">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">extract_intensity_q_lineout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fft_gpu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_increments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_bandwidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#extract_intensity_q_lineout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.extract_intensity_q_lineout" title="Link to this definition"></a></dt>
<dd><p>Function performs azimuthal intensity integrations as function of q for selected q bandwidth.
:param fft_gpu: Pytorch tensor fourier transform
:param q_increments: integration coarseness
:param q_bandwidth: halfwidth of bandpass filter
:param dx: resolution in Angstrom / pixel
:param device: cuda device
:return: x, y lists with values for x (q) and y (counts) to construct lineout</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.gaussian_q_filter">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">gaussian_q_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#gaussian_q_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.gaussian_q_filter" title="Link to this definition"></a></dt>
<dd><p>Generates gaussian filter in Fourier space for designated q center and bandwidth.
:param q: q vector in angstroms
:param sigma_q: q bandwidth in angstroms
:param sigma_th: theta bandwidth in degrees
:param M: size of output fourier transform image
:param dx: HRTEM image resolution in Angstroms/pixel</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array of size (NN, NN) with gaussian filter. Normalized by area (sum = 2).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.get_datacube">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">get_datacube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_gpu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.924</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qintensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#get_datacube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.get_datacube" title="Link to this definition"></a></dt>
<dd><p>Get intensity - theta 4D array. Saves 4D array output.
:param img_gpu: GPU tensor of raw image
:param angles: np array with angles to probe
:param step_size: size of steps during ‘rastering’
:param selected_filter: gaussian filter - numpy of size (M, M) (potentially combined with bandpass filter) to rotate and use for analysis
:param bandpass: bandpass filter - numpy of size (M, M)
:param N: Size of nano-image in pixels
:param M: size of FFT
:param device: name of GPU CUDA device
:param dx: pixel resolution in Angstrom/pixel
:param plot_freq: integer to determine frequency to plot window analysis. No plots shown if set to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>4D pyTorch tensor containing integrated intesity for every (row, col, theta)
q datacube: 4D np array containing the q linecuts counts for every (row,col,q)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>datacube</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.get_orientation_torch">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">get_orientation_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#get_orientation_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.get_orientation_torch" title="Link to this definition"></a></dt>
<dd><p>Gets Intensity tensor for different angles at any grid point (x,y). Uses broadcasting and torch
operations to speed 2x process with respect to loop.
:param fft: GPU torch tensor of fourier transform
:param filters: GPU torch tensor of gaussian filters to be applied (different angles)
:param device: CUDA device
:return: intensity tensor at grid point x,y</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.get_q_pixels">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">get_q_pixels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#get_q_pixels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.get_q_pixels" title="Link to this definition"></a></dt>
<dd><p>Conversion of reciprocal space component in angstroms to spatial frequency in number of pixels.
:param q: reciprocal space vector (2pi/d)
:param M: size of Fourier transform
:param dx: HRTEM image resolution in Angstroms/pixel</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>q in pixel size</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>f_pixels</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.make_gaussian_filter_tensor">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">make_gaussian_filter_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">single_filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#make_gaussian_filter_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.make_gaussian_filter_tensor" title="Link to this definition"></a></dt>
<dd><p>Generates 3D tensor of size (M, M, number_angles) with stack of rotated Fourier filters to be used for
datacube extraction.
:param single_filter: Initial filter as numpy array of size (M, M)
:param angles: list or numpy array with rotation angles
:param device: CUDA device send final output tensor
:return: 3D filters tensor with series of filters for azimuthal information extraction</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.median_filter">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">median_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#median_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.median_filter" title="Link to this definition"></a></dt>
<dd><p>Median filter operation for n-dimension tensor or array. Function first checks if data is pyTorch tensor or numpy,
then performs median filter operation using numpy and returns same datatype as input.
Can be relatively slow operation because only performed once per image/datacube.
:param data: torch tensor or numpy array to apply median filter to
:param device: CUDA device
:param size: size of sliding window. Default is size = 1
:return: Median filtered tensor or numpy array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.normalize_tensor">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">normalize_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#normalize_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.normalize_tensor" title="Link to this definition"></a></dt>
<dd><p>Tensor normalization operation. Tensor/mean - 1.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.raised_cosine_window_np">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">raised_cosine_window_np</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#raised_cosine_window_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.raised_cosine_window_np" title="Link to this definition"></a></dt>
<dd><p>Generate 1D raised cosine window of length s and with roll-factor beta.
:param s: pixel lenght of signal
:param beta: roll-factor beta. Default=0.2 mainly zeroes down signal close to edges of image.
:return:</p>
<blockquote>
<div><p>frequencies, window: frequency values and corresponding raised cosine signal</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.subplot_mini">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">subplot_mini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_raw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I_vs_th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.924</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#subplot_mini"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.subplot_mini" title="Link to this definition"></a></dt>
<dd><p>Plots stack of figures to describe nano-FFT extraction process. From left to right,
the following figures are plot: real space  nano-image, raw FFT, and filtered FFT.
:param image: real-space image
:param fft_raw: calculated FFT
:param fft_masked: FFT multiplied with bandpass filter
:param title: optional title for first subplot
:param dx: image resolution in Angstrom/pixel
:param save_fig: filename in case user wants to save plot</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.tensor_fft">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">tensor_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#tensor_fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.tensor_fft" title="Link to this definition"></a></dt>
<dd><p>Returns powder spectrum of 2D tensor (image) using PyTorch implementation.
NOTE: location of operation (GPU or CPU) is determined by location of input tensor.
Send tensor to GPU prior to using this function to perform operations in GPU (i.e. tensor.to(cuda))
:param tensor: 2D tensor (image)
:param s: output size of FFT (s x s). tensor is padded with zeros prior to performing FFT operation
:param to specified output size.:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>powder spectra (real^2 + complex^2) tensor of size (s x s) with Fourier Transform.</dt><dd><p>DC frequency component is set in center of tensor.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>fft</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytem.cc_reduce_data.tensor_shift_fft">
<span class="sig-prename descclassname"><span class="pre">pytem.cc_reduce_data.</span></span><span class="sig-name descname"><span class="pre">tensor_shift_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fft</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytem/cc_reduce_data.html#tensor_shift_fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytem.cc_reduce_data.tensor_shift_fft" title="Link to this definition"></a></dt>
<dd><p>Shift zero frequency spatial frequency component to center of 2D image. For Pytorch implementation
:param fft: 2D FFT obtained using torch_fft function</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>shifted FFT with DC frequency component in center of image.</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pytem.cc_drift_correction.track_drift.html" class="btn btn-neutral float-left" title="pytem.cc_drift_correction.track_drift" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pytem.cc_reduce_data.bandpass_filter.html" class="btn btn-neutral float-right" title="pytem.cc_reduce_data.bandpass_filter" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Christina Cheng.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>